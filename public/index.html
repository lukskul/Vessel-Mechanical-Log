<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mechanical Maintenance Log</title>
    <style>

        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #saved-data {
            text-align: left;
        }
        .icon {
            color: grey; 
        }
        h2 {
            text-align: left;
        }
        label {
            text-align: left;
            font-weight: bold;
            font-size: 1.3rem;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input,
        .form-group select,
        .form-group button {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        .form-group button {
            margin-top: 10px;
            width: 25%; 
        }
        #data-list {
            margin-top: 20px;
        }
        .autocomplete-suggestions {
            border: 1px solid #ccc;
            max-height: 150px;
            overflow-y: auto;
        }
        .autocomplete-suggestion {
            padding: 10px;
            cursor: pointer;
        }
        .autocomplete-suggestion:hover {
            background-color: #e9e9e9;
        }
        .task-options {
            display: flex;
            flex-wrap: wrap;
        }
        .task-option {
            flex: 1 1 30%;
            margin: 5px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
        }
        .task-option:hover {
            background-color: #e9e9e9;
        }
        .task-option img {
            display: block;
            margin: 0 auto 5px;
            max-width: 40px;
            max-height: 40px;
        }
        .task-option.selected {
            background-color: #cfe2f3;
        }
        .hidden {
            visibility: hidden;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Mechanical Maintenance Log</h1>
        <form id="create-boat-form">
            <h2>Vessel</h2>
            <div class="form-group">
                <label for="boat-name"></label>
                <input type="text" id="boat-name" name="boat-name" autocomplete="off" required>
                <div id="autocomplete-suggestions" class="autocomplete-suggestions"></div>
            </div>
            <div class="form-group">
                <button type="submit" id="create-boat-button">Add New Vessel</button>
            </div>
        </form>

        <form id="update-work-form">
            <div class="form-group">
                <label for="task-select">Select Task:</label>
                <div id="task-options" class="task-options">
                    <div class="task-option" data-task="engines">
                        <img src="icons/engine.svg" alt="Engines">
                        <span>Engine</span>
                    </div>
                    <div class="task-option" data-task="generators">
                        <img src="icons/generator.svg" alt="Generator">
                        <span>Generator</span>
                    </div>
                    <div class="task-option" data-task="electricMotors">
                        <img src="icons/motor.svg" alt="Electric Motors">
                        <span>Electric motor</span>
                    </div>
                    <div class="task-option" data-task="shafts">
                        <img src="icons/shaft.png" alt="Shafts">
                        <span>Shaft and Coupler</span>
                    </div>
                    <div class="task-option" data-task="props">
                        <img src="icons/props.svg" alt="Props">
                        <span>Propeller</span>
                    </div>
                    <div class="task-option" data-task="bow-thrusters">
                        <img src="icons/bowThruster.svg" alt="Bow Thrusters">
                        <span>Bow Thruster</span>
                    </div>
                    <div class="task-option" data-task="sea-screens">
                        <img src="icons/screen.svg" alt="Sea Screens">
                        <span>Sea Screens</span>
                    </div>
                    <div class="task-option" data-task="zincs">
                        <img src="icons/zincs.svg" alt="Zincs">
                        <span>Zincs</span>
                    </div>
                    <div class="task-option" data-task="doors">
                        <img src="icons/door.svg" alt="doors"> 
                        <span>Doors</span>
                    </div>
                    <div class="task-option" data-task="misc">
                        <img src="icons/plus.svg" alt="Add New">
                        <span>Misc Work</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="work-done">Work Done:</label>
                <input type="text" id="work-done" name="work-done" required>
            </div>
            <div class="form-group">
                <button type="submit">Save</button>
            </div>
        </form>

        <div id="data-list">
            <h2>Saved Data:</h2>
            <pre id="saved-data">[]</pre>
        </div>
    </div>
<!-- Existing Code ... -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const createBoatForm = document.getElementById('create-boat-form');
    const updateWorkForm = document.getElementById('update-work-form');
    const boatNameInput = document.getElementById('boat-name'); // Change to boat-name
    const createBoatButton = document.getElementById('create-boat-button');
    const suggestionsBox = document.getElementById('autocomplete-suggestions');
    const savedDataElement = document.getElementById('saved-data');
    const taskOptions = document.getElementById('task-options');
    let selectedTask = null;
    let savedData = JSON.parse(localStorage.getItem('boatData')) || [];

    function renderData() {
        savedDataElement.textContent = JSON.stringify(savedData, null, 2);
        renderBoatOptions();
    }

    function renderBoatOptions() {
        boatNameInput.innerHTML = '';

        // Create and append the pre-loaded option
        const preLoadedOption = document.createElement('option');
        preLoadedOption.value = '';
        preLoadedOption.textContent = 'Select';
        boatNameInput.appendChild(preLoadedOption);

        savedData.forEach((boat, index) => {
            const option = document.createElement('option');
            option.value = boat.name; // Set the value to the boat name
            option.textContent = boat.name;
            boatNameInput.appendChild(option);
        });
    }

    function showSuggestions(value) {
        suggestionsBox.innerHTML = '';
        if (value.length === 0) {
            createBoatButton.style.display = 'block';
            return;
        }
        const filteredData = savedData.filter(boat => boat.name.toLowerCase().includes(value.toLowerCase()));
        filteredData.forEach((boat, index) => {
            const suggestion = document.createElement('div');
            suggestion.classList.add('autocomplete-suggestion');
            suggestion.textContent = boat.name;
            suggestion.dataset.index = index;
            suggestionsBox.appendChild(suggestion);
        });
        if (filteredData.some(boat => boat.name.toLowerCase() === value.toLowerCase())) {
            createBoatButton.style.display = 'none';
        } else {
            createBoatButton.style.display = 'block';
        }
    }

    boatNameInput.addEventListener('input', function() {
        showSuggestions(this.value);
    });

    suggestionsBox.addEventListener('click', function(event) {
        const target = event.target;
        if (target.classList.contains('autocomplete-suggestion')) {
            boatNameInput.value = target.textContent;
            boatNameInput.dataset.index = target.dataset.index;
            suggestionsBox.innerHTML = '';
            createBoatButton.style.display = 'none';
        }
    });

    createBoatForm.addEventListener('submit', function(event) {
        event.preventDefault();
        const boatName = boatNameInput.value;
        const existingIndex = boatNameInput.dataset.index;
        if (existingIndex) {
            boatNameInput.value = existingIndex;
        } else {
            const newBoat = { name: boatName, work: [] };
            savedData.push(newBoat);
            localStorage.setItem('boatData', JSON.stringify(savedData));
            renderData();
        }
        createBoatForm.reset();
        delete boatNameInput.dataset.index;
        createBoatButton.style.display = 'block';
    });

    updateWorkForm.addEventListener('submit', function(event) {
        event.preventDefault();
        const selectedIndex = boatNameInput.value; // Get the name of the selected boat
        const workDone = document.getElementById('work-done').value;
        if (selectedIndex !== '' && selectedTask) {
            const today = new Date().toISOString().split('T')[0];
            const workEntry = { [selectedTask]: [{ date: today, notes: workDone }] };
            savedData.find(boat => boat.name === selectedIndex).work.push(workEntry);
            localStorage.setItem('boatData', JSON.stringify(savedData));
            renderData();
            updateWorkForm.reset();
            selectedTask = null;
            const selectedOption = document.querySelector('.task-option.selected');
            if (selectedOption) {
                selectedOption.classList.remove('selected');
            }
        }
    });

    taskOptions.addEventListener('click', function(event) {
        const target = event.target.closest('.task-option');
        if (target) {
            const previousSelected = document.querySelector('.task-option.selected');
            if (previousSelected) {
                previousSelected.classList.remove('selected');
            }
            target.classList.add('selected');
            selectedTask = target.dataset.task;
        }
    });

    renderData();
});
</script>

<!-- Existing Code ... -->

</body>
</html>